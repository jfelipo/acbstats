<html><head>
    <title>NBA Statistics Viewer</title>
    <!-- vendor these? -->
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.4.0/dist/sql-wasm.js" integrity="sha512-8oJoeo0ykAzuJzQFJDnwz9t4Rr+1xue7LFX+kr0NJMpOHH9QJPC563If+sakheUe3QbLwTTgXIGPC6YZTwp7Iw==" crossorigin="anonymous"></script>-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.4.0/dist/sql-wasm.js"></script>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="viewer.js"></script>
<style>
pre {
  margin: 0px;
}
text.label {
  font: 12px sans-serif;
}
text.pointLabel {
  font: 10px sans-serif;
}
</style>
  </head>
  <body>
    <div>
      <svg id="canvas" width="1024" height="768"></svg>
    </div>
    <div style="margin-top: 50px">
      <span>X axis: <select id="statx"></select></span>
      <br>
      Y axis: <select id="staty"></select></span>
      <br>
      <span>radius:
        <select id="radius">
          <option value="8" selected>constant: 8</option>
          <option value="4">constant: 4</option>
        </select>
      </span>
    </div>
    <div style="margin-top: 20px">
      <span style="margin-left: 40px">
        <label for="teamcolors">Team Colors</label><input type="checkbox" id="teamcolors" checked></input>
      </span>
    </div>
    <div style="margin-top: 20px" class="settings">
      width: <input type="text" id="settings-width"></input>
      <span style="margin-left: 40px">
        height: <input type="text" id="settings-height"></input>
      </span>
      <br>
      minRadius: <input type="text" id="settings-min-radius"></input>
      <span style="margin-left: 40px">
        maxRadius: <input type="text" id="settings-max-radius"></input>
      </span>
    </div>
    <div style="margin-top: 20px">
      filter: <textarea
        id="filter"
        value=""
        rows=10
        cols=100
        style="width: 500px">
-- select the top 2/3 of the league by fga
with player_stats as (
  select *, ntile(100) over (order by fga) as fga_pctile from players
)
select * from player_stats
where fga_pctile > 95;
      </textarea>
      <span style="margin-left: 40px">
        <button id="applyFilter">filter</button>
        <p>
        The filter syntax is a work in progress, and I'll add some UI eventually, but here's some you can try:
        <ul>
          <li><pre>select * from players where usg_pct &gt; 26 and fga &gt; 80</pre></li>
          <li><pre>select * from players where team in ('BOS', 'MIA', 'BRK')</pre></li>
          <li><pre>player.team == 'BOS'</pre></li>
          <li><pre>quantile(player, 'fga', 80) || quantile(player, 'trb', 80)</pre></li>
          <li><pre>player.pts_per_g &gt; 20</pre></li>
        </ul>
        <a href="https://www.sqlite.org/windowfunctions.html">sqlite window functions documentation</a>
      </span>
    </div>
    <a href="https://github.com/llimllib/nbastats/">source code</a>
  </body>
</html>
